{
  "_from": "authy-client@^1.1.1",
  "_id": "authy-client@1.1.1",
  "_inBundle": false,
  "_integrity": "sha512-HQJXt/6JwGgfvavjnUAuyX4WuwTeafbSRjsanvY6R4mJUtboVLtn59cQVF+7YJfE3B8+gLbJDaQr7U4kPI9uEw==",
  "_location": "/authy-client",
  "_phantomChildren": {},
  "_requested": {
    "escapedName": "authy-client",
    "fetchSpec": "^1.1.1",
    "name": "authy-client",
    "raw": "authy-client@^1.1.1",
    "rawSpec": "^1.1.1",
    "registry": true,
    "saveSpec": null,
    "type": "range"
  },
  "_requiredBy": [
    "#USER",
    "/"
  ],
  "_resolved": "https://registry.npmjs.org/authy-client/-/authy-client-1.1.1.tgz",
  "_shasum": "bb59ac1eb4fefa62b62fc7545d360afa6b580ffa",
  "_spec": "authy-client@^1.1.1",
  "_where": "/Users/dat/Desktop/node-sms-notification",
  "author": {
    "name": "Rui Marinho",
    "url": "https://github.com/ruimarinho"
  },
  "bin": {
    "authy": "dist/src/bin/cli.js"
  },
  "bugs": {
    "url": "https://github.com/ruimarinho/authy-client/issues"
  },
  "bundleDependencies": false,
  "dependencies": {
    "@uphold/request-logger": "^2.0.0",
    "bluebird": "^3.4.6",
    "debugnyan": "^1.0.0",
    "google-libphonenumber": "^3.0.10",
    "lodash": "^4.16.2",
    "prettyjson": "^1.2.1",
    "qs": "^6.2.1",
    "request": "^2.75.0",
    "standard-http-error": "^2.0.0",
    "urijs": "^1.18.2",
    "url-escape-tag": "^1.0.0",
    "validator": "^9.2.0",
    "validator.js": "^2.0.3",
    "validator.js-asserts": "^3.0.1",
    "yargs": "^10.0.3"
  },
  "deprecated": false,
  "description": "A complete Authy client with support for TOTP, OneTouch, Phone Verification and Phone Intelligence APIs",
  "devDependencies": {
    "babel-cli": "^6.14.0",
    "babel-eslint": "^8.1.2",
    "babel-plugin-add-module-exports": "^0.2.1",
    "babel-plugin-transform-async-to-module-method": "^6.8.0",
    "babel-preset-es2015-node4": "^2.1.0",
    "babel-preset-stage-1": "^6.13.0",
    "babel-register": "^6.14.0",
    "eslint": "^4.14.0",
    "eslint-config-uphold": "^0.1.0",
    "mocha": "^4.1.0",
    "nock": "^9.1.5",
    "nyc": "^11.4.1",
    "pre-commit": "^1.1.3",
    "should": "^13.2.0"
  },
  "engines": {
    "node": ">=4"
  },
  "homepage": "https://github.com/ruimarinho/authy-client",
  "keywords": [
    "2 factor",
    "2fa",
    "2step",
    "auth",
    "authentication",
    "authy",
    "client",
    "co",
    "two factor",
    "two step",
    "two-factor"
  ],
  "license": "MIT",
  "main": "dist/src/index.js",
  "name": "authy-client",
  "nyc": {
    "include": [
      "src/"
    ],
    "report-dir": "./coverage"
  },
  "optionalDependencies": {},
  "options": {
    "mocha": "--recursive --require babel-register --require should"
  },
  "pre-commit": [
    "lint"
  ],
  "readme": "# authy-client\n\nA complete Authy client with support for TOTP, OneTouch, Phone Verification and Phone Intelligence APIs.\n\n## Status\n\n[![npm version][npm-image]][npm-url] [![build status][travis-image]][travis-url]\n\n## Installation\n\nInstall the package via `yarn`:\n\n```sh\nyarn add authy-client\n```\n\nor via `npm`:\n\n```sh\nnpm install authy-client --save\n```\n\n## Usage\n\n### Client\n\nThe following is a complete example of registering a user and requesting an SMS using any of the three possible async APIs offered by this package.\n\n###### Using await/async (requires `babel`)\n\n```javascript\nimport { Client } from 'authy-client';\n\nconst client = new Client({ key: 'foo' });\n\n(async function() {\n  const { user: { id: authyId } } = await client.registerUser({\n    countryCode: 'PT',\n    email: 'foo@bar.com',\n    phone: '911234567' }\n  );\n  const { cellphone } = await client.requestSms({ authyId });\n\n  console.log(`SMS requested to ${cellphone}`)\n}());\n```\n\n###### Using promises\n\n```javascript\nconst Client = require('authy-client').Client;\nconst client = new Client({ key: 'foo' });\n\nclient.registerUser({\n  countryCode: 'PT',\n  email: 'foo@bar.com',\n  phone: '911234567'\n}).then(function(response) {\n  return response.user.id;\n}).then(function(authyId) {\n  return client.requestSms({ authyId: authyId });\n}).then(function(response) {\n  console.log(`SMS requested to ${response.cellphone}`);\n});\n```\n\n###### Using callbacks\n\n```javascript\nconst Client = require('authy-client').Client;\nconst client = new Client({ key: 'foo' });\n\nclient.registerUser({\n  countryCode: 'PT',\n  email: 'foo@bar.com',\n  phone: '911234567'\n}, function(err, res) {\n  if (err) throw err;\n\n  client.requestSms({ authyId: res.user.id }, function(err, res) {\n    if (err) throw err;\n\n    console.log(`SMS requested to ${res.cellphone}`)\n  });\n});\n```\n\nIf you want to run this example without first transpiling it, you can install the `babel-cli` package and run `node_modules/.bin/babel-node example.js`.\n\n### Command-line interface\n\nAnother option of interacting with Authy's API is by using the available command-line interface (cli). It handles most tasks without require any coding.\n\n![demo](cli.gif)\n\n```sh\n❯ authy\nCommands:\n  activity <command>     Manage activity\n  application <command>  Manage application information\n  onetouch <command>     Manage onetouch requests\n  phone <command>        Manage phone verifications\n  user <command>         Manage users\n\nOptions:\n  --key     API Key                                          [string] [required]\n  --pretty  Whether to print pretty results            [boolean] [default: true]\n  --help    Show help                                                  [boolean]\n```\n\nNote that all calls must be authenticated using the API Key. However, if you prefer, you can define the API Key using the environment variable `AUTHY_KEY` such as:\n\n```sh\n❯ AUTHY_KEY=foobar authy <command>\n```\n\n### Client({ key }, [options])\n\n### Arguments\n\n1. `args` _(Object)_: the required arguments object.\n2. `args.key` _(string)_: The private API key obtained from the [Authy Dashboard](https://dashboard.authy.com/).\n3. `[options]` _(Object)_: The options object.\n4. `[options.host=https://api.authy.com]` _(string)_: The target API endpoint.\n5. `[options.timeout=5000]` _(number)_: The maximum request time, in milliseconds.\n\n##### Example\n\n```javascript\nnew Client({ key: 'foo' }, { timeout: 10000 });\n```\n\n### TOTP API\n\nAuthy TOTP (Time-based One-time Password) is an API that allows application developers to enable two-factor authentication (2FA) for a user. 2FA, as the name suggests, is an additional step to secure an user's account or action by comparing a code generated or sent to the user's mobile phone against a shared secret.\n\n##### registerUser({ countryCode, email, phone }, [callback])\nCreate an Authy user based on the users mobile phone number and email. The returned Authy Id should be stored on your database for subsequent calls.\n\nThe library automatically converts conforming country codes (e.g. `US`) to the corresponding country calling code (e.g. `1`) and validates the resulting phone number thoroughly before submitting it to Authy.\n\n#### Arguments\n\n1. `args` _(Object)_: the required arguments object.\n2. `args.countryCode` _(string)_: the user's phone country code in ISO 3166 alpha 2 format (**recommended** format, e.g. `US`) or a numeric country calling code (use at your own risk).\n3. `args.email` _(string)_: the user's email address.\n4. `args.phone` _(string)_: the user's phone number.\n5. `[callback]` _(Function)_: a callback, otherwise a Promise is returned.\n\n##### Example\n###### Using await/async (requires `babel`)\n\n```javascript\nconst { user: { id: authyId } } = await client.registerUser({ countryCode: 'PT', email: 'foo@bar.com', phone: '911234567' });\n\nconsole.log('Authy Id', authyId);\n```\n\n###### Using promises\n\n```javascript\nclient.registerUser({ countryCode: 'PT', email: 'foo@bar.com', phone: '911234567' })\n  .then(function(response) {\n    console.log('Authy Id', response.user.id);\n  })\n  .catch(function(error) {\n    throw error;\n  });\n```\n\n###### Using callbacks\n\n```javascript\nclient.registerUser({ countryCode: 'PT', email: 'foo@bar.com', phone: '911234567' }, function(err, res) {\n  if (err) throw err;\n\n  console.log('Authy Id', res.user.id);\n});\n```\n\n##### Using cli\n\n```sh\n❯ AUTHY_KEY=foobar authy user create 911234567 PT foo@bar.com\n```\n\n#### requestSms({ authyId }, [options, callback])\n\nRequest an SMS with a token for users that don't own a smartphone. If the Authy app is in use by the user, this request is ignored and a push notification is sent instead.\n\n##### Arguments\n\n1. `args` _(Object)_: the required arguments object.\n2. `args.authyId` _(string)_: the user's Authy Id.\n3. `[options]` _(Object)_: the options object.\n4. `[options.action]` _(string)_: the action or context that is being validated.\n5. `[options.force]` _(boolean)_: whether to send an SMS even if the user is using the mobile application.\n6. `[options.message]` _(string)_: a message for the specific action, if one is set.\n7. `[callback]` _(Function)_: a callback, otherwise a Promise is returned.\n\n##### Example\n\n###### Using await/async (requires `babel`)\n\n```javascript\nconst response = await client.requestSms({ authyId: 1635 });\n\nconsole.log('Message sent successfully to', response.cellphone);\n```\n\n###### Using promises\n\n```javascript\nclient.requestSms({ authyId: 1635 })\n  .then(function(response) {\n    console.log('Message sent successfully to', response.cellphone);\n  })\n  .catch(function(error) {\n    throw error;\n  });\n```\n\n###### Using callbacks\n\n```javascript\nclient.requestSms({ authyId: 1635 }, function(err, res) {\n  if (err) throw err;\n\n  console.log('Message sent successfully to', res.cellphone);\n});\n```\n\n###### Using cli\n\n```sh\n❯ AUTHY_KEY=foobar authy user request sms 1635\n```\n\n#### requestCall({ authyId }, [options, callback])\n\nRequest a call with a token for users that don't own a smartphone. If the Authy app is in use by the user, this request is ignored and a push notification is sent instead.\n\n##### Arguments\n\n1. `args` _(Object)_: the required arguments object.\n2. `args.authyId` _(string)_: the user's Authy Id.\n3. `[options]` _(Object)_: the options object.\n4. `[options.action]` _(string)_: the action or context that is being validated.\n5. `[options.force]` _(boolean)_: whether to call the user even if the mobile application is in use.\n6. `[options.message]` _(string)_: a message for the specific action, if one is set.\n7. `[callback]` _(Function)_: a callback, otherwise a Promise is returned.\n\n##### Example\n\n###### Using await/async (requires `babel`)\n\n```javascript\nconst response = await client.requestCall({ authyId: 1635 });\n\nconsole.log('Call requested successfully to', response.cellphone);\n```\n\n###### Using promises\n\n```javascript\nclient.requestCall({ authyId: 1635 })\n  .then(function(response) {\n    console.log('Call requested successfully to', response.cellphone);\n  })\n  .catch(function(error) {\n    throw error;\n  });\n```\n\n###### Using callbacks\n\n```javascript\nclient.requestCall({ authyId: 1635 }, function(err, res) {\n  if (err) throw err;\n\n  console.log('Call requested successfully to', res.cellphone);\n});\n```\n\n###### Using cli\n\n```sh\n❯ AUTHY_KEY=foobar authy user request call 1635\n```\n\n#### verifyToken({ authyId, token }, [options, callback])\n\nVerify if a token submitted by the user is valid or not.\n\n##### Arguments\n\n1. `args` _(Object)_: the required arguments object.\n2. `args.authyId` _(string)_: the user's Authy Id.\n3. `args.token` _(string)_: the token to verify.\n4. `[options]` _(Object)_: the options object.\n5. `[options.force]` _(boolean)_: whether to verify the token regardless of the user's login status.\n6. `[callback]` _(Function)_: a callback, otherwise a Promise is returned.\n\n##### Example\n\n###### Using await/async (requires `babel`)\n\n```javascript\nconst response = await client.verifyToken({ authyId: 1635, token: '1234567' });\n\nconsole.log('Token is valid');\n```\n\n###### Using promises\n\n```javascript\nclient.verifyToken({ authyId: 1635, token: '1234567' })\n  .then(function(response) {\n    console.log('Token is valid');\n  })\n  .catch(function(error) {\n    throw error;\n  });\n```\n\n###### Using callbacks\n\n```javascript\nclient.verifyToken({ authyId: 1635, token: '1234567' }, function(err, res) {\n  if (err) throw err;\n\n  console.log('Token is valid');\n});\n```\n\n###### Using cli\n\n```sh\n❯ AUTHY_KEY=foobar authy user verify --token 1234567\n```\n\n#### deleteUser({ authyId }, [options, callback])\n\nDelete a user from the application.\n\n##### Arguments\n\n1. `args` _(Object)_: the required arguments object.\n2. `args.authyId` _(string)_: the user's Authy Id.\n3. `[options]` _(Object)_: the options object.\n4. `[options.ip]` _(string)_: the IP requesting to delete the user.\n5. `[callback]` _(Function)_: a callback, otherwise a Promise is returned.\n\n##### Example\n\n###### Using await/async (requires `babel`)\n\n```javascript\nconst response = await client.deleteUser({ authyId: 1635 });\n\nconsole.log('User has been scheduled for deletion');\n```\n\n###### Using promises\n\n```javascript\nclient.deleteUser({ authyId: 1635 })\n  .then(function(response) {\n    console.log('User has been scheduled for deletion');\n  })\n  .catch(function(error) {\n    throw error;\n  });\n```\n\n###### Using callbacks\n\n```javascript\nclient.deleteUser({ authyId: 1635 }, function(err, res) {\n  if (err) throw err;\n\n  console.log('User has been scheduled for deletion');\n});\n```\n\n###### Using cli\n\n```sh\n❯ AUTHY_KEY=foobar authy user delete 1635\n```\n\n##### registerActivity({ authyId, data, type }, [options, callback])\n\nRegister a user activity.\n\n##### Arguments\n\n1. `args` _(Object)_: the required arguments object.\n2. `args.authyId` _(string)_: the user's Authy Id.\n3. `args.type` _(string)_: the activity type (one of `password_reset`, `banned`, `unbanned` or `cookie_login`).\n4. `[data]` _(Object)_: a data object associated with the activity.\n5. `[options]` _(Object)_: the options object.\n6. `[options.ip]` _(string)_: the IP of the user registering the activity.\n7. `[callback]` _(Function)_: a callback, otherwise a Promise is returned.\n\n##### Example\n\n###### Using await/async (requires `babel`)\n\n```javascript\nconst response = await client.registerActivity({ authyId: 1635, data: { reason: 'foo' }, type: 'banned' }, { ip: '127.0.0.1' });\n\nconsole.log('Activity registered');\n```\n\n###### Using promises\n\n```javascript\nclient.registerActivity({ authyId: 1635, data: { reason: 'foo' }, type: 'banned' }, { ip: '127.0.0.1' })\n  .then(function(response) {\n    console.log('Activity registered');\n  })\n  .catch(function(error) {\n    throw error;\n  });\n```\n\n###### Using callbacks\n\n```javascript\nclient.registerActivity({ authyId: 1635, data: { reason: 'foo' }, type: 'banned' }, { ip: '127.0.0.1' }, function(err, res) {\n  if (err) throw err;\n\n  console.log('Activity registered');\n});\n```\n\n###### Using cli\n\n```sh\n❯ AUTHY_KEY=foobar authy activity create 1635 \\\n    --data.reason foo \\\n    --type banned \\\n    --ip 127.0.0.1\n```\n\n#### getUserStatus({ authyId }, [options, callback])\n\nRetrieve the user status, such as the registered country code, phone number, devices and confirmation status.\n\n##### Arguments\n\n1. `args` _(Object)_: the required arguments object.\n2. `args.authyId` _(string)_: the user's Authy Id.\n3. `[options]` _(Object)_: the options object.\n4. `[options.ip]` _(string)_: the IP of the user requesting to see the user details.\n5. `[callback]` _(Function)_: a callback, otherwise a Promise is returned.\n\n##### Example\n\n###### Using await/async (requires `babel`)\n\n```javascript\nconst response = await client.getUserStatus({ authyId: 1635 });\n\nconsole.log('User status', response.status);\n```\n\n###### Using promises\n\n```javascript\nclient.getUserStatus({ authyId: 1635 })\n  .then(function(response) {\n    console.log('User status', response.status);\n  })\n  .catch(function(error) {\n    throw error;\n  });\n```\n\n###### Using callbacks\n\n```javascript\nclient.getUserStatus({ authyId: 1635 }, function(err, res) {\n  if (err) throw err;\n\n  console.log('User status', response.status);\n});\n```\n\n###### Using cli\n\n```sh\n❯ AUTHY_KEY=foobar authy user get status 1635\n```\n\n#### getApplicationDetails([options, callback])\n\nRetrieve application details such as its name or current billing plan.\n\n##### Arguments\n\n1. `[options]` _(Object)_: the options object.\n2. `[options.ip]` _(string)_: the IP of the user requesting to see the application details.\n3. `[callback]` _(Function)_: a callback, otherwise a Promise is returned.\n\n##### Example\n\n###### Using await/async (requires `babel`)\n\n```javascript\nconst response = await client.getApplicationDetails();\n\nconsole.log('Application details', response.app);\n```\n\n###### Using promises\n\n```javascript\nclient.getApplicationDetails()\n  .then(function(response) {\n    console.log('Application details', response.app);\n  })\n  .catch(function(error) {\n    throw error;\n  });\n```\n\n###### Using callbacks\n\n```javascript\nclient.getApplicationDetails(function(err, res) {\n  if (err) throw err;\n\n  console.log('Application details', response.app);\n});\n```\n\n###### Using cli\n\n```sh\n❯ AUTHY_KEY=foobar authy application get details\n```\n\n#### getApplicationStatistics([options, callback])\n\nRetrieve application statistics by month and current quotas.\n\n##### Arguments\n\n1. `[options]` _(Object)_: the options object.\n2. `[options.ip]` _(string)_: the IP of the user requesting to see the application statistics.\n3. `[callback]` _(Function)_: a callback, otherwise a Promise is returned.\n\n##### Example\n\n###### Using await/async (requires `babel`)\n\n```javascript\nconst response = await client.getApplicationStatistics();\n\nconsole.log('Application statistics', response);\n```\n\n###### Using promises\n\n```javascript\nclient.getApplicationStatistics()\n  .then(function(response) {\n    console.log('Application statistics', response);\n  })\n  .catch(function(error) {\n    throw error;\n  });\n```\n\n###### Using callbacks\n\n```javascript\nclient.getApplicationStatistics(function(err, res) {\n  if (err) throw err;\n\n  console.log('Application statistics', response);\n});\n```\n\n###### Using cli\n\n```sh\n❯ AUTHY_KEY=foobar authy application get statistics\n```\n\n### Phone Verification API\n\nThe Phone Verification API allows for a simple phone verification for situations where the complexity of the TOTP API is not required. First, a code is sent to the user's phone number and then that code is submitted back by the user. Authy verifies that the code matches the one issued for it.\n\n#### startPhoneVerification({ countryCode, phone, via }, [options, callback])\n\nVerify a phone number by sending it a verification code by SMS or call. Custom messages for the SMS are currently not working so support has not been added.\n\n##### Arguments\n\n1. `args` _(Object)_: the required arguments object.\n2. `args.countryCode` _(string)_: the user's phone country code in ISO 3166 alpha 2 format (**recommended** format, e.g. `US`) or a numeric country calling code (use at your own risk).\n3. `args.phone` _(string)_: the user's phone number to verify.\n4. `args.via` _(string)_: the mechanism used to send the verification code (`sms` or `call`).\n5. `[options]` _(Object)_: the options object.\n6. `[options.locale]` _(string)_: the locale of the message received by the user. If none is given, Authy will attempt to auto-detect it based on the country code passed, otherwise English will be used.\n7. `[callback]` _(Function)_: a callback, otherwise a Promise is returned.\n\n##### Example\n\n###### Using await/async (requires `babel`)\n\n```javascript\nimport { enums } from 'authy-client';\n\nconst response = await client.startPhoneVerification({ countryCode: 'US', locale: 'en', phone: '7754615609', via: enums.verificationVia.SMS });\n\nconsole.log('Phone information', response);\n```\n\n###### Using promises\n\n```javascript\nconst enums = require('authy-client').enums;\n\nclient.startPhoneVerification({ countryCode: 'US', locale: 'en', phone: '7754615609', via: enums.verificationVia.SMS })\n  .then(function(response) {\n    console.log('Phone information', response);\n  })\n  .catch(function(error) {\n    throw error;\n  });\n```\n\n###### Using callbacks\n\n```javascript\nconst enums = require('authy-client').enums;\n\nclient.startPhoneVerification({ countryCode: 'US', locale: 'en', phone: '7754615609', via: enums.verificationVia.SMS }, function(err, res) {\n  if (err) throw err;\n\n  console.log('Phone information', response);\n});\n```\n\n###### Using cli\n\n```sh\n❯ AUTHY_KEY=foobar authy phone verify 7754615609 US \\\n    --locale=en \\\n    --via=sms\n```\n\n#### verifyPhone({ countryCode, phone, token }, [callback])\n\nVerify a phone number through a verification code.\n\n##### Arguments\n\n1. `args` _(Object)_: the required arguments object.\n2. `args.countryCode` _(string)_: the user's phone country code in ISO 3166 alpha 2 format (**recommended** format, e.g. `US`) or a numeric country calling code (use at your own risk).\n3. `args.phone` _(string)_: the user's phone number to verify.\n4. `args.token` _(string)_: the token submitted by the user to verify the phone.\n5. `[callback]` _(Function)_: a callback, otherwise a Promise is returned.\n\n##### Example\n\n###### Using await/async (requires `babel`)\n\n```javascript\nconst response = await client.verifyPhone({ countryCode: 'US', phone: '7754615609', token: '1234' });\n\nconsole.log('Verification code is correct');\n```\n\n###### Using promises\n\n```javascript\nclient.verifyPhone({ countryCode: 'US', phone: '7754615609', token: '1234' })\n  .then(function(response) {\n    console.log('Verification code is correct');\n  })\n  .catch(function(error) {\n    throw error;\n  });\n```\n\n###### Using callbacks\n\n```javascript\nclient.verifyPhone({ countryCode: 'US', phone: '7754615609', token: '1234' }, function(err, res) {\n  if (err) throw err;\n\n  console.log('Verification code is correct');\n});\n```\n\n###### Using cli\n\n```sh\n❯ AUTHY_KEY=foobar authy phone verify 7754615609 US --token 1234\n```\n\n### Phone Intelligence API\n\nThe Phone Intelligence API allows an application developer to retrieve information about a specific number such as its type (VoIP, landline or mobile) and carrier.\n\n#### getPhoneInformation({ countryCode, phone }, [options, callback])\n\nVerify a phone number by sending it a verification code by SMS or call. Custom messages for the SMS are currently not working so support has not been added.\n\n##### Arguments\n\n1. `args` _(Object)_: the required arguments object.\n2. `args.countryCode` _(string)_: the phone's country code in ISO 3166 alpha 2 format (**recommended** format, e.g. `US`) or a numeric country calling code (use at your own risk).\n3. `args.phone` _(string)_: the phone's number to retrieve information about.\n4. `[options]` _(Object)_: the options object.\n5. `[options.ip]` _(string)_: the IP of the user requesting to retrieve information about the phone.\n6. `[callback]` _(Function)_: a callback, otherwise a Promise is returned.\n\n##### Example\n\n###### Using await/async (requires `babel`)\n\n```javascript\nconst response = await client.getPhoneInformation({ countryCode: 'US', phone: '7754615609' });\n\nconsole.log('Phone information', response);\n```\n\n###### Using promises\n\n```javascript\nclient.getPhoneInformation({ countryCode: 'US', phone: '7754615609' })\n  .then(function(response) {\n    console.log('Phone information', response);\n  })\n  .catch(function(error) {\n    throw error;\n  });\n```\n\n###### Using callbacks\n\n```javascript\nclient.getPhoneInformation({ countryCode: 'US', phone: '7754615609' }, function(err, res) {\n  if (err) throw err;\n\n  console.log('Phone information', response);\n});\n```\n\n###### Using cli\n\n```sh\n❯ AUTHY_KEY=foobar authy phone get information 7754615609 US\n```\n\n### OneTouch API\n\nAuthy OneTouch is an API that allows application developers to create simple _approval requests_ so that users can frictionless _approve_ or _deny_ such request. It can be used for a variety of purposes, such as authentication (e.g. login approval) or validation (e.g. financial transaction approval).\n\nWhen the user takes actions, Authy sends a GET or POST callback to a URL defined on the application dashboard. The request, which can optionally be cryptographically verified, allows for immediate reaction. An alternate polling method can also be used.\n\n#### createApprovalRequest({ authyId, details, logos, message }, [options, callback])\n\nCreate an approval request for the given Authy Id and send it to the user as a push notification.\n\n##### Arguments\n\n1. `args` _(Object)_: the required arguments object.\n2. `args.authyId` _(string)_: the user's Authy Id.\n3. `args.message` _(string)_: the message shown to the user upon receiving the approval request.\n4. `[details]` _(Object)_: the details object.\n5. `[details.hidden]` _(Object)_: a dictionary of hidden details associated with the approval request.\n6. `[details.visible]` _(Object)_: a dictionary of visible details associated with the approval request.\n7. `[logos]` _(array)_: the custom logos collection.\n8. `[logos.<n>]` _(Object)_: a custom logo object.\n9. `[logos.<n>.res]` _(string)_: the target resolution of the custom logo (one of `default`, `low`, `med` or `high`).\n10. `[logos.<n>.url]` _(string)_: the url of the custom logo image.\n11. `[options]` _(Object)_: the options object.\n12. `[options.ttl]` _(integer)_: the number of seconds that the approval request will be available for being responded. If set to `0`, the approval request won't expire.\n13. `[callback]` _(Function)_: a callback, otherwise a Promise is returned.\n\n##### Example\n\n###### Using await/async (requires `babel`)\n\n```javascript\nconst response = await client.createApprovalRequest({\n  authyId: 1635,\n  details: {\n    hidden: {\n      ip_address: '10.10.3.203'\n    },\n    visible: {\n      'Account Number': '981266321',\n      location: 'California, USA',\n      username: 'Bill Smith'\n    }\n  },\n  logos: [{\n    res: 'default',\n    url: 'https://example.com/logos/default.png'\n  }, {\n    res: 'low',\n    url: 'https://example.com/logos/low.png'\n  }],\n  message: 'Login requested for a CapTrade Bank account.',\n}, {\n  ttl: 120\n});\n\nconsole.log('Approval request UUID', response.approval_request.uuid);\n```\n\n###### Using promises\n\n```javascript\nclient.createApprovalRequest({\n  authyId: 1635,\n  details: {\n    hidden: {\n      ip_address: '10.10.3.203'\n    },\n    visible: {\n      'Account Number': '981266321',\n      location: 'California, USA',\n      username: 'Bill Smith'\n    }\n  },\n  logos: [{\n    res: 'default',\n    url: 'https://example.com/logos/default.png'\n  }, {\n    res: 'low',\n    url: 'https://example.com/logos/low.png'\n  }],\n  message: 'Login requested for a CapTrade Bank account.',\n}, {\n  ttl: 120\n}).then(function(response) {\n  console.log('Approval request UUID', response.approval_request.uuid);\n}).catch(function(error) {\n  throw error;\n});\n```\n\n###### Using callbacks\n\n```javascript\nclient.createApprovalRequest({\n  authyId: 1635,\n  details: {\n    hidden: {\n      ip_address: '10.10.3.203'\n    },\n    visible: {\n      'Account Number': '981266321',\n      location: 'California, USA',\n      username: 'Bill Smith'\n    }\n  },\n  logos: [{\n    res: 'default',\n    url: 'https://example.com/logos/default.png'\n  }, {\n    res: 'low',\n    url: 'https://example.com/logos/low.png'\n  }],\n  message: 'Login requested for a CapTrade Bank account.',\n}, {\n  ttl: 120\n}, function(err, res) {\n  if (err) throw err;\n\n  console.log('Approval request UUID', response.approval_request.uuid);\n});\n```\n\n###### Using cli\n\n```sh\n❯ AUTHY_KEY=foobar authy onetouch create 1635 \\\n  'Login requested for a CapTrade Bank account.' \\\n  --hidden.ip_address 10.10.3.203 \\\n  --logos.0.res default \\\n  --logos.0.url 'https://example.com/logos/default.png' \\\n  --logos.1.res low \\\n  --logos.1.url 'https://example.com/logos/low.png' \\\n  --visible.'Account Number' 981266321 \\\n  --visible.location 'California, USA' \\\n  --visible.username 'Bill Smith' \\\n  --ttl 120\n```\n\n#### getApprovalRequest({ id }, [callback])\n\nGet information about an approval request.\n\n##### Arguments\n\n1. `args` _(Object)_: the required arguments object.\n2. `args.id` _(string)_: the id of the approval request.\n3. `[callback]` _(Function)_: a callback, otherwise a Promise is returned.\n\n##### Example\n\n###### Using await/async (requires `babel`)\n\n```javascript\nconst response = await client.getApprovalRequest({ id: '550e8400-e29b-41d4-a716-446655440000' });\n\nconsole.log('Approval request', response.approval_request);\n```\n\n###### Using promises\n\n```javascript\nclient.getApprovalRequest({ id: '550e8400-e29b-41d4-a716-446655440000' })\n  .then(function(response) {\n    console.log('Approval request', response.approval_request);\n  })\n  .catch(function(error) {\n    throw error;\n  });\n```\n\n###### Using callbacks\n\n```javascript\nclient.getApprovalRequest({ id: '550e8400-e29b-41d4-a716-446655440000' }, function(err, res) {\n  if (err) throw err;\n\n  console.log('Approval request', response.approval_request);\n});\n```\n\n###### Using cli\n\n```sh\n❯ AUTHY_KEY=foobar authy phone get status 550e8400-e29b-41d4-a716-446655440000\n```\n\n#### verifyCallback({ body, headers, method, protocol, url }, [callback])\n\nAuthy callbacks contain a header (`X-Authy-Signature`) with an HTTP HMAC signature of the request. This signature can be used to verify the authenticity of the request.\n\nCurrently, GET requests cannot be validated, as only POST requests contain such signature.\n\nIf you have configured your Authy application to receive callbacks for OneTouch approval requests, you should verify their authenticity.\n\n##### Arguments\n\n1. `args` _(Object)_: the required arguments object.\n2. `args.body` _(Object)_: the parsed body of the request.\n3. `args.headers` _(Object)_: the headers of the request.\n4. `args.method` _(string)_: the method of the request (`GET` or `POST`).\n5. `args.protocol` _(string)_: the protocol of the request (`http` or `https`).\n6. `args.url` _(string)_: the url of the request (e.g. `/callback/onetouch`).\n7. `[callback]` _(Function)_: a callback, otherwise a Promise is returned.\n\n##### Example\n\n###### Using await/async (requires `babel`)\n\n```javascript\nawait client.verifyCallback({\n  body: {\n    approval_request: {\n      expiration_timestamp: 1455911778,\n      logos: null,\n      transaction: {\n        created_at_time: 1455825378,\n        customer_uuid: '2ccf0040-ed25-0132-5987-0e67b818e6fb',\n        details: {},\n        device_details: null,\n        device_geolocation: null,\n        device_signing_time: 0,\n        encrypted: false,\n        flagged: false,\n        hidden_details: {},\n        message: '.',\n        reason: null,\n        requester_details: null,\n        status: 'approved',\n        uuid: '996201c0-b7a7-0133-7c06-0e67b818e6fb'\n      }\n    },\n    authy_id: 1234567,\n    callback_action: 'approval_request_status',\n    device_uuid: '4d89c320-a9bb-0133-7c02-0e67b818e6fb',\n    signature: 'BObhJgZwgU7O9r4Uo9VT6j6shAOe7y/IRGpW/N0Uq34/XHZU9E+aHOI5rcQzW1ZgNCECzVrqrsnjhYEK4Zq1naKWu0YNkuvILmMz8IxJEQH+c+6x186fjIjxvP4nu4p/pfUDomo/za24s1XOjtNlVsrDTDXClHUh5MjFQbyBjhFd8gOtmGVatN7K2Lx71I8YR2JDLbRX4DlJEMu++PLBn1nqQH9tbNYzX5jjX87CXPBtDfRwfWSs/imnfZ9zkDq4ZKuBcuwzQNsxKlby6782X0o78rYhCHrcDnHgRtyMGvX9ovK3XTt6M7p6i9SKaRgBWIOFVPygxv15iJesqt9cng==',\n    status: 'approved',\n    uuid: '996221c0-b7a7-0133-7c06-0e67b818e6fb'\n  },\n  headers: {\n    host: 'foo.bar',\n    'x-authy-signature': 'hqB6las54sMBA83GKs0U1QQi9ocJ2tH20SXHZNzfqqQ=',\n    'x-authy-signature-nonce': 1455825429\n  },\n  method: 'POST',\n  protocol: 'https',\n  url: '/'\n});\n\nconsole.log('Approval request callback is valid');\n```\n\n###### Using promises\n\n```javascript\nclient.verifyCallback({\n  body: {\n    approval_request: {\n      expiration_timestamp: 1455911778,\n      logos: null,\n      transaction: {\n        created_at_time: 1455825378,\n        customer_uuid: '2ccf0040-ed25-0132-5987-0e67b818e6fb',\n        details: {},\n        device_details: null,\n        device_geolocation: null,\n        device_signing_time: 0,\n        encrypted: false,\n        flagged: false,\n        hidden_details: {},\n        message: '.',\n        reason: null,\n        requester_details: null,\n        status: 'approved',\n        uuid: '996201c0-b7a7-0133-7c06-0e67b818e6fb'\n      }\n    },\n    authy_id: 1234567,\n    callback_action: 'approval_request_status',\n    device_uuid: '4d89c320-a9bb-0133-7c02-0e67b818e6fb',\n    signature: 'BObhJgZwgU7O9r4Uo9VT6j6shAOe7y/IRGpW/N0Uq34/XHZU9E+aHOI5rcQzW1ZgNCECzVrqrsnjhYEK4Zq1naKWu0YNkuvILmMz8IxJEQH+c+6x186fjIjxvP4nu4p/pfUDomo/za24s1XOjtNlVsrDTDXClHUh5MjFQbyBjhFd8gOtmGVatN7K2Lx71I8YR2JDLbRX4DlJEMu++PLBn1nqQH9tbNYzX5jjX87CXPBtDfRwfWSs/imnfZ9zkDq4ZKuBcuwzQNsxKlby6782X0o78rYhCHrcDnHgRtyMGvX9ovK3XTt6M7p6i9SKaRgBWIOFVPygxv15iJesqt9cng==',\n    status: 'approved',\n    uuid: '996221c0-b7a7-0133-7c06-0e67b818e6fb'\n  },\n  headers: {\n    host: 'foo.bar',\n    'x-authy-signature': 'hqB6las54sMBA83GKs0U1QQi9ocJ2tH20SXHZNzfqqQ=',\n    'x-authy-signature-nonce': 1455825429\n  },\n  method: 'POST',\n  protocol: 'https',\n  url: '/'\n}).then(function(response) {\n  console.log('Approval request callback is valid');\n})\n.catch(function(error) {\n  throw error;\n});\n```\n\n###### Using callbacks\n\n```javascript\nclient.verifyCallback({\n  body: {\n    approval_request: {\n      expiration_timestamp: 1455911778,\n      logos: null,\n      transaction: {\n        created_at_time: 1455825378,\n        customer_uuid: '2ccf0040-ed25-0132-5987-0e67b818e6fb',\n        details: {},\n        device_details: null,\n        device_geolocation: null,\n        device_signing_time: 0,\n        encrypted: false,\n        flagged: false,\n        hidden_details: {},\n        message: '.',\n        reason: null,\n        requester_details: null,\n        status: 'approved',\n        uuid: '996201c0-b7a7-0133-7c06-0e67b818e6fb'\n      }\n    },\n    authy_id: 1234567,\n    callback_action: 'approval_request_status',\n    device_uuid: '4d89c320-a9bb-0133-7c02-0e67b818e6fb',\n    signature: 'BObhJgZwgU7O9r4Uo9VT6j6shAOe7y/IRGpW/N0Uq34/XHZU9E+aHOI5rcQzW1ZgNCECzVrqrsnjhYEK4Zq1naKWu0YNkuvILmMz8IxJEQH+c+6x186fjIjxvP4nu4p/pfUDomo/za24s1XOjtNlVsrDTDXClHUh5MjFQbyBjhFd8gOtmGVatN7K2Lx71I8YR2JDLbRX4DlJEMu++PLBn1nqQH9tbNYzX5jjX87CXPBtDfRwfWSs/imnfZ9zkDq4ZKuBcuwzQNsxKlby6782X0o78rYhCHrcDnHgRtyMGvX9ovK3XTt6M7p6i9SKaRgBWIOFVPygxv15iJesqt9cng==',\n    status: 'approved',\n    uuid: '996221c0-b7a7-0133-7c06-0e67b818e6fb'\n  },\n  headers: {\n    host: 'foo.bar',\n    'x-authy-signature': 'hqB6las54sMBA83GKs0U1QQi9ocJ2tH20SXHZNzfqqQ=',\n    'x-authy-signature-nonce': 1455825429\n  },\n  method: 'POST',\n  protocol: 'https',\n  url: '/'\n}, function(err, res) {\n  if (err) throw err;\n\n  console.log('Approval request callback is valid');\n});\n```\n\n## Tests\n\nTo test using a local installation of `node.js`:\n\n```sh\nnpm test\n```\n\nTo test using Docker exclusively:\n\n```sh\ndocker-compose run --rm sut\n```\n\n## Release\n\n```sh\nnpm version [<newversion> | major | minor | patch] -m \"Release %s\"\n```\n\n## License\n\nMIT\n\n[npm-image]: https://img.shields.io/npm/v/authy-client.svg?style=flat-square\n[npm-url]: https://npmjs.org/package/authy-client\n[travis-image]: https://img.shields.io/travis/ruimarinho/authy-client.svg?style=flat-square\n[travis-url]: https://travis-ci.org/ruimarinho/authy-client\n",
  "readmeFilename": "README.md",
  "repository": {
    "type": "git",
    "url": "git+https://github.com/ruimarinho/authy-client.git"
  },
  "scripts": {
    "changelog": "github_changelog_generator --no-issues --header-label='# Changelog' --future-release=v$npm_config_future_release && sed -i '' -e :a -e '$d;N;2,4ba' -e 'P;D' CHANGELOG.md",
    "coverage": "nyc --reporter=html --reporter=text npm test",
    "lint": "eslint src test",
    "prepublish": "npm run transpile",
    "test": "NODE_ENV=test mocha $npm_package_options_mocha",
    "testdocker": "docker-compose run --rm sut",
    "transpile": "rm -rf dist/* && babel src --out-dir dist/src && babel test --out-dir dist/test && cp package.json dist/",
    "version": "npm run changelog --future-release=$npm_package_version && npm run transpile && git add -A CHANGELOG.md dist"
  },
  "version": "1.1.1"
}
